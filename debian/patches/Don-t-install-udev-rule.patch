From 94c4e6d241244cafc037083b23191f253631b154 Mon Sep 17 00:00:00 2001
From: Pauli Nieminen <suokkos@gmail.com>
Date: Thu, 2 Jun 2011 19:17:41 +0300
Subject: [PATCH] Don't install udev rule

Instlling udev rule is pointless when sysprof is using standard
kernel interface for profiling.

Signed-off-by: Pauli Nieminen <suokkos@gmail.com>
---
 Makefile.am |    3 ---
 Makefile.in |   36 +++++++-----------------------------
 2 files changed, 7 insertions(+), 32 deletions(-)

Index: sysprof/Makefile.am
===================================================================
--- sysprof.orig/Makefile.am	2011-07-26 12:15:21.370628560 +0530
+++ sysprof/Makefile.am	2011-07-26 12:31:56.237357163 +0530
@@ -61,9 +61,6 @@
 
 endif
 
-udevdir = $(sysconfdir)/udev/rules.d
-dist_udev_DATA = 60-sysprof.rules
-
 pixmapsdir = $(datadir)/pixmaps
 
 dist_pkgdata_DATA = sysprof.glade
Index: sysprof/Makefile.in
===================================================================
--- sysprof.orig/Makefile.in	2011-07-26 12:15:21.370628560 +0530
+++ sysprof/Makefile.in	2011-07-26 12:34:42.159774498 +0530
@@ -38,7 +38,7 @@
 noinst_PROGRAMS = testelf$(EXEEXT) testunwind$(EXEEXT)
 subdir = .
 DIST_COMMON = README $(am__configure_deps) $(dist_pixmaps_DATA) \
-	$(dist_pkgdata_DATA) $(dist_udev_DATA) $(srcdir)/Makefile.am \
+	$(dist_pkgdata_DATA) $(srcdir)/Makefile.am \
 	$(srcdir)/Makefile.in $(srcdir)/config.h.in \
 	$(top_srcdir)/configure AUTHORS COPYING ChangeLog INSTALL NEWS \
 	TODO build-aux/compile build-aux/depcomp build-aux/install-sh \
@@ -56,7 +56,7 @@
 CONFIG_CLEAN_VPATH_FILES =
 @BUILD_GUI_TRUE@am__EXEEXT_1 = sysprof$(EXEEXT)
 am__installdirs = "$(DESTDIR)$(bindir)" "$(DESTDIR)$(pixmapsdir)" \
-	"$(DESTDIR)$(pkgdatadir)" "$(DESTDIR)$(udevdir)"
+	"$(DESTDIR)$(pkgdatadir)"
 PROGRAMS = $(bin_PROGRAMS) $(noinst_PROGRAMS)
 am__sysprof_SOURCES_DIST = binfile.h binfile.c collector.c collector.h \
 	demangle.c elfparser.c elfparser.h profile.h profile.c sfile.h \
@@ -147,7 +147,7 @@
 am__base_list = \
   sed '$$!N;$$!N;$$!N;$$!N;$$!N;$$!N;$$!N;s/\n/ /g' | \
   sed '$$!N;$$!N;$$!N;$$!N;s/\n/ /g'
-DATA = $(dist_pixmaps_DATA) $(dist_pkgdata_DATA) $(dist_udev_DATA)
+DATA = $(dist_pixmaps_DATA) $(dist_pkgdata_DATA)
 ETAGS = etags
 CTAGS = ctags
 DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
@@ -303,8 +303,6 @@
 @BUILD_GUI_TRUE@	-DPIXMAPDIR=\"$(pixmapsdir)\"
 
 @BUILD_GUI_TRUE@sysprof_LDADD = $(GUI_DEP_LIBS)
-udevdir = $(sysconfdir)/udev/rules.d
-dist_udev_DATA = 60-sysprof.rules
 pixmapsdir = $(datadir)/pixmaps
 dist_pkgdata_DATA = sysprof.glade
 dist_pixmaps_DATA = sysprof-icon-16.png sysprof-icon-24.png sysprof-icon-32.png sysprof-icon-48.png
@@ -1110,26 +1108,6 @@
 	test -n "$$files" || exit 0; \
 	echo " ( cd '$(DESTDIR)$(pkgdatadir)' && rm -f" $$files ")"; \
 	cd "$(DESTDIR)$(pkgdatadir)" && rm -f $$files
-install-dist_udevDATA: $(dist_udev_DATA)
-	@$(NORMAL_INSTALL)
-	test -z "$(udevdir)" || $(MKDIR_P) "$(DESTDIR)$(udevdir)"
-	@list='$(dist_udev_DATA)'; test -n "$(udevdir)" || list=; \
-	for p in $$list; do \
-	  if test -f "$$p"; then d=; else d="$(srcdir)/"; fi; \
-	  echo "$$d$$p"; \
-	done | $(am__base_list) | \
-	while read files; do \
-	  echo " $(INSTALL_DATA) $$files '$(DESTDIR)$(udevdir)'"; \
-	  $(INSTALL_DATA) $$files "$(DESTDIR)$(udevdir)" || exit $$?; \
-	done
-
-uninstall-dist_udevDATA:
-	@$(NORMAL_UNINSTALL)
-	@list='$(dist_udev_DATA)'; test -n "$(udevdir)" || list=; \
-	files=`for p in $$list; do echo $$p; done | sed -e 's|^.*/||'`; \
-	test -n "$$files" || exit 0; \
-	echo " ( cd '$(DESTDIR)$(udevdir)' && rm -f" $$files ")"; \
-	cd "$(DESTDIR)$(udevdir)" && rm -f $$files
 
 ID: $(HEADERS) $(SOURCES) $(LISP) $(TAGS_FILES)
 	list='$(SOURCES) $(HEADERS) $(LISP) $(TAGS_FILES)'; \
@@ -1334,7 +1312,7 @@
 check: check-am
 all-am: Makefile $(PROGRAMS) $(DATA) config.h
 installdirs:
-	for dir in "$(DESTDIR)$(bindir)" "$(DESTDIR)$(pixmapsdir)" "$(DESTDIR)$(pkgdatadir)" "$(DESTDIR)$(udevdir)"; do \
+	for dir in "$(DESTDIR)$(bindir)" "$(DESTDIR)$(pixmapsdir)" "$(DESTDIR)$(pkgdatadir)"; do \
 	  test -z "$$dir" || $(MKDIR_P) "$$dir"; \
 	done
 install: install-am
@@ -1386,8 +1364,7 @@
 
 info-am:
 
-install-data-am: install-dist_pixmapsDATA install-dist_pkgdataDATA \
-	install-dist_udevDATA
+install-data-am: install-dist_pixmapsDATA install-dist_pkgdataDATA
 
 install-dvi: install-dvi-am
 
@@ -1435,7 +1412,7 @@
 ps-am:
 
 uninstall-am: uninstall-binPROGRAMS uninstall-dist_pixmapsDATA \
-	uninstall-dist_pkgdataDATA uninstall-dist_udevDATA
+	uninstall-dist_pkgdataDATA
 
 .MAKE: all install-am install-strip
 
@@ -1448,7 +1425,7 @@
 	dvi-am html html-am info info-am install install-am \
 	install-binPROGRAMS install-data install-data-am \
 	install-dist_pixmapsDATA install-dist_pkgdataDATA \
-	install-dist_udevDATA install-dvi install-dvi-am install-exec \
+	install-dvi install-dvi-am install-exec \
 	install-exec-am install-html install-html-am install-info \
 	install-info-am install-man install-pdf install-pdf-am \
 	install-ps install-ps-am install-strip installcheck \
@@ -1456,7 +1433,7 @@
 	maintainer-clean-generic mostlyclean mostlyclean-compile \
 	mostlyclean-generic pdf pdf-am ps ps-am tags uninstall \
 	uninstall-am uninstall-binPROGRAMS uninstall-dist_pixmapsDATA \
-	uninstall-dist_pkgdataDATA uninstall-dist_udevDATA
+	uninstall-dist_pkgdataDATA
 
 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
